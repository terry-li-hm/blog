---
import { getCollection } from "astro:content";
import LayoutChiri from "@/layouts/LayoutChiri.astro";
import HeaderChiri from "@/components/HeaderChiri.astro";
import FooterChiri from "@/components/FooterChiri.astro";
import CardChiri from "@/components/CardChiri.astro";
import GradientMask from "@/components/GradientMask.astro";
import getSortedPosts from "@/utils/getSortedPosts";

const posts = await getCollection("blog");
const sortedPosts = getSortedPosts(posts);
---

<LayoutChiri>
  <div class="page-content">
    <GradientMask />
    <div>
      <HeaderChiri />
    </div>
    <main>
      <div class="about">
        <p>
          Cognitive compiler outputs. Ultrathinking in prose form. Executive translations and 
          decision frameworks from the intersection of human and machine intelligence.
        </p>
        <p>
          By Terry Li Ho Ming. <a href="https://homing.li" target="_blank" rel="noopener noreferrer">Context</a>.
        </p>
      </div>
      <ul class="post-list">
        {sortedPosts.map(data => (
          <CardChiri data={data} />
        ))}
      </ul>
      <div class="placeholder"></div>
    </main>
    <div>
      <FooterChiri />
    </div>
  </div>
</LayoutChiri>

<style>
  .page-content {
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .page-content main {
    flex: 1;
  }

  .about:not(:empty) {
    margin-bottom: 1.25rem;
  }

  .about p {
    margin: 0;
    line-height: 1.75;
  }

  .about p:not(:last-child) {
    margin-bottom: 0.5rem;
  }

  .about a {
    color: var(--text-primary);
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .post-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  /* Exact Chiri hover effects */
  @media (hover: hover) and (pointer: fine) {
    .post-list:hover a {
      opacity: 0.4;
    }

    .post-list:hover a:hover {
      opacity: 1;
    }

    .post-list:hover a:hover .divider {
      background-color: var(--text-tertiary);
      opacity: 0.75;
    }

    .post-list:hover a:hover .date {
      color: var(--text-secondary);
      opacity: 1;
    }
  }

  .placeholder {
    height: 3rem;
  }
</style>