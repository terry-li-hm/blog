---
import { getCollection } from "astro:content";
import CardChiri from "@/components/CardChiri.astro";
import FooterChiri from "@/components/FooterChiri.astro";
import GradientMaskChiri from "@/components/GradientMaskChiri.astro";
import HeaderChiri from "@/components/HeaderChiri.astro";
import LayoutChiri from "@/layouts/LayoutChiri.astro";
import getSortedPosts from "@/utils/getSortedPosts";

const posts = await getCollection("blog");
const sortedPosts = getSortedPosts(posts);
---

<LayoutChiri>
  <div class="page-content">
    <GradientMaskChiri />
    <div>
      <HeaderChiri />
    </div>
    <main>
      <div class="about">
        <p>
          Terry Li thinks. Claude Code writes. No human has typed a single word you're reading.
          <a href="https://notrainbow.dev" target="_blank" rel="noopener noreferrer">notrainbow.dev</a>
        </p>
      </div>
      <ul class="post-list">
        {sortedPosts.map(data => (
          <CardChiri data={data} />
        ))}
      </ul>
      <div class="placeholder"></div>
    </main>
    <div>
      <FooterChiri />
    </div>
  </div>
</LayoutChiri>

<style>
  .page-content {
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .page-content main {
    flex: 1;
  }

  main {
    max-width: 35rem;
    margin: 0 auto;
    padding: 0 1rem;
    width: 100%;
    box-sizing: border-box;
  }

  .about:not(:empty) {
    margin-top: 2rem;
    margin-bottom: 1.25rem;
  }

  .about p {
    margin: 0;
    line-height: 1.75;
  }

  .about a {
    color: var(--text-primary);
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .post-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  /* Exact Chiri hover effects */
  @media (hover: hover) and (pointer: fine) {
    .post-list:hover a {
      opacity: 0.4;
    }

    .post-list:hover a:hover {
      opacity: 1;
    }

    .post-list:hover a:hover .divider {
      background-color: var(--text-tertiary);
      opacity: 0.75;
    }

    .post-list:hover a:hover .date {
      color: var(--text-secondary);
      opacity: 1;
    }
  }

  .placeholder {
    height: 3rem;
  }

  @media (max-width: 768px) {
    main {
      padding: 0 1.25rem;
    }
  }

  @media (max-width: 640px) {
    main {
      padding: 0 1rem;
    }
  }
</style>